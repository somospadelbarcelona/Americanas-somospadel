<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <script src="js/security-core.js"></script>
    <script src="js/core/SecurityArmor.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Control - Americanas PRO</title>
    <link rel="stylesheet" href="css/style.css?v=1002">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700;800&family=Inter:wght@300;400;500;600&display=swap"
        rel="stylesheet">
    <!-- FontAwesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- SheetJS for Excel Export -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>

    <script>
        // AUTO-LOGIN Y AUTO-LOAD: Sistema completo de inicializaci√≥n
        window.addEventListener('DOMContentLoaded', () => {
            console.log('üöÄ Inicializando panel admin...');

            const savedUser = localStorage.getItem('adminUser') || localStorage.getItem('currentUser');
            if (savedUser) {
                try {
                    const user = JSON.parse(savedUser);
                    const validRoles = ['super_admin', 'superadmin', 'admin', 'admin_player', 'captain', 'capitan', 'capitanes'];
                    const hasRole = user.role && validRoles.includes(user.role.toLowerCase());

                    if (hasRole) {
                        console.log('‚úÖ Sesi√≥n admin detectada:', user.name);

                        // Ocultar modal
                        const modal = document.getElementById('admin-auth-modal');
                        if (modal) {
                            modal.style.display = 'none';
                            modal.style.visibility = 'hidden';
                            modal.style.opacity = '0';
                            modal.classList.add('hidden');
                            console.log('üîí Modal ocultado');
                        }

                        // Esperar a que admin.js se cargue y luego cargar la vista
                        const checkAndLoad = setInterval(() => {
                            if (typeof loadAdminView === 'function') {
                                clearInterval(checkAndLoad);
                                console.log('üìä Cargando vista de usuarios...');
                                loadAdminView('users');
                            }
                        }, 100);

                        // Timeout de seguridad (10 segundos)
                        setTimeout(() => {
                            clearInterval(checkAndLoad);
                            if (typeof loadAdminView !== 'function') {
                                console.error('‚ùå loadAdminView no se carg√≥. Recarga la p√°gina.');
                            }
                        }, 10000);
                    }
                } catch (e) {
                    console.error('Error al verificar sesi√≥n:', e);
                }
            } else {
                console.log('üîí No hay sesi√≥n activa. Mostrando login...');
            }
        });
    </script>
</head>

<body>

    <!-- Auth Modal for Admin -->
    <div id="admin-auth-modal" class="modal-overlay auth-overlay-enterprise">
        <div class="modal-content admin-login-card">
            <div style="text-align: center; margin-bottom: 2.5rem;">
                <img src="img/logo_somospadel.png"
                    style="height: 100px; margin-bottom: 1.5rem; filter: drop-shadow(0 0 15px var(--primary-glow));"
                    alt="Somos Padel">
                <h2
                    style="color: white !important; font-weight: 900; letter-spacing: 2px; text-shadow: 0 0 10px rgba(0,0,0,0.5);">
                    ACCESO PRIVADO</h2>
                <div
                    style="color: var(--primary); font-size: 0.7rem; font-weight: 800; letter-spacing: 3px; margin-top: 5px;">
                    SOMOS P√ÅDEL BARCELONA</div>
            </div>
            <form id="admin-login-form" class="pro-form"
                onsubmit="event.preventDefault(); document.getElementById('admin-login-btn').click(); return false;">
                <div class="form-group">
                    <label
                        style="color: rgba(255,255,255,0.7); text-align: center; width: 100%; letter-spacing: 1px;">C√ìDIGO
                        DE ACCESO (6 D√çGITOS)</label>
                    <input type="tel" name="pin" id="pin-input" placeholder="------" class="pro-input"
                        style="text-align: center; letter-spacing: 15px; font-size: 1.8rem; font-weight: 900; background: rgba(0,0,0,0.3); border: 2px solid rgba(255,255,255,0.1); color: var(--brand-neon, #ccff00);"
                        maxlength="6" inputmode="numeric" required autofocus autocomplete="off">
                </div>

                <div class="form-group"
                    style="flex-direction: row; align-items: center; gap: 10px; margin-top: 15px; justify-content: center;">
                    <input type="checkbox" name="remember" id="remember-me" style="width: auto;">
                    <label for="remember-me"
                        style="margin: 0; color: rgba(255,255,255,0.8); font-size: 0.8rem;">Mantener sesi√≥n
                        iniciada</label>
                </div>

                <button type="button" id="admin-login-btn" class="btn-primary-pro"
                    onclick="const val = document.getElementById('pin-input').value; console.log('PIN Submitted:', val); if(window.AdminAuth) { window.AdminAuth.login(val); } else { alert('Error: AdminAuth no cargado'); }"
                    style="width: 100%; padding: 1.2rem; margin-top: 1.5rem; font-size: 1.1rem; letter-spacing: 2px;">ENTRAR
                    A LA APP üöÄ</button>

                <div id="admin-login-error"
                    style="color: var(--danger); margin-top: 1.2rem; text-align: center; font-size: 0.85rem; font-weight: 700; min-height: 20px;">
                </div>

                <div
                    style="margin-top: 2rem; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1rem; text-align: center;">
                    <p style="color: rgba(255,255,255,0.4); font-size: 0.7rem;">ACCESO RESTRINGIDO POR ROLES</p>
                    <div style="display: flex; justify-content: center; gap: 10px; margin-top: 5px; opacity: 0.5;">
                        <span style="font-size: 1.2rem;" title="Super Admin">üëë</span>
                        <span style="font-size: 1.2rem;" title="Admin">üõ°Ô∏è</span>
                        <span style="font-size: 1.2rem;" title="Captain">üß¢</span>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <div class="app-shell">
        <!-- Mobile Menu Button -->
        <button id="mobile-menu-btn" class="mobile-menu-toggle" onclick="toggleAdminSidebar()">
            <i class="fas fa-bars"></i>
        </button>

        <!-- Sidebar Overlay for Mobile -->
        <div id="sidebar-overlay" class="sidebar-overlay" onclick="toggleAdminSidebar()"></div>

        <!-- Enterprise Admin Sidebar -->
        <aside id="admin-sidebar" class="sidebar-pro">
            <div class="brand-top-left">
                <img src="img/logo_somospadel.png" class="brand-logo-main" alt="Somos Padel Logo">
                <div class="brand-text-main">
                    <span class="name">SOMOSPADEL</span>
                    <span class="location">barcelona</span>
                </div>
            </div>

            <nav class="nav-menu">
                <a href="index.html" class="nav-item-pro nav-item-back"
                    style="text-decoration: none; margin-bottom: 2rem;">
                    <span class="icon-box"><i class="fas fa-arrow-left"></i></span>
                    <span class="nav-text">Dashboard Jugador</span>
                </a>

                <button class="nav-item-pro active" data-view="users" onclick="loadAdminView('users')">
                    <span class="icon-box"><i class="fas fa-users-gear"></i></span>
                    <span class="nav-text">Base de Datos</span>
                </button>

                <button class="nav-item-pro nav-group-americana" data-view="americanas_mgmt"
                    onclick="loadAdminView('americanas_mgmt')">
                    <span class="icon-box"><i class="fas fa-calendar-check"></i></span>
                    <span class="nav-text">Gesti√≥n Americanas</span>
                </button>

                <button class="nav-item-pro nav-group-americana" data-view="matches" onclick="loadAdminView('matches')">
                    <span class="icon-box"><i class="fas fa-trophy-award"></i></span>
                    <span class="nav-text">Resultados Americanas</span>
                </button>

                <button class="nav-item-pro nav-group-americana" data-view="simulator_empty"
                    onclick="loadAdminView('simulator_empty')">
                    <span class="icon-box"><i class="fas fa-robot"></i></span>
                    <span class="nav-text">Simulador de Americanas</span>
                </button>

                <div
                    style="margin: 15px 10px 5px 10px; padding: 10px; border-top: 1px solid rgba(255,255,255,0.05); color: rgba(255,255,255,0.3); font-size: 0.65rem; font-weight: 800; letter-spacing: 1px; text-transform: uppercase;">
                    M√≥dulo Entrenos</div>

                <button class="nav-item-pro nav-group-entreno" data-view="entrenos_mgmt"
                    onclick="loadAdminView('entrenos_mgmt')">
                    <span class="icon-box"><i class="fas fa-graduation-cap"></i></span>
                    <span class="nav-text">Gesti√≥n Entrenos</span>
                </button>

                <button class="nav-item-pro nav-group-entreno" data-view="entrenos_results"
                    onclick="loadAdminView('entrenos_results')">
                    <span class="icon-box"><i class="fas fa-clipboard-check"></i></span>
                    <span class="nav-text">Resultados Entrenos</span>
                </button>

                <button class="nav-item-pro nav-group-entreno" data-view="entrenos_simulator"
                    onclick="loadAdminView('entrenos_simulator')">
                    <span class="icon-box"><i class="fas fa-brain"></i></span>
                    <span class="nav-text">Simulador de Entrenos</span>
                </button>

                <div
                    style="margin: 15px 10px 5px 10px; padding: 10px; border-top: 1px solid rgba(255,255,255,0.05); color: rgba(255,255,255,0.3); font-size: 0.65rem; font-weight: 800; letter-spacing: 1px; text-transform: uppercase;">
                    Herramientas</div>

                <button class="nav-item-pro" data-view="fix_players" onclick="loadAdminView('fix_players')">
                    <span class="icon-box"><i class="fas fa-wrench"></i></span>
                    <span class="nav-text">Reparar IDs Jugadores</span>
                </button>

                <button class="nav-item-pro" data-view="menu_mgmt" onclick="loadAdminView('menu_mgmt')">
                    <span class="icon-box"><i class="fas fa-bars-staggered"></i></span>
                    <span class="nav-text">MENU 3 PESTA√ëAS</span>
                </button>

                <button class="nav-item-pro" data-view="config" onclick="loadAdminView('config')">
                    <span class="icon-box"><i class="fas fa-sliders"></i></span>
                    <span class="nav-text">Ajustes Engine</span>
                </button>

                <button class="nav-item-pro nav-item-logout" style="margin-top: auto;" onclick="AdminAuth.logout()">
                    <span class="icon-box"><i class="fas fa-power-off"></i></span>
                    <span class="nav-text">Cerrar Sesi√≥n</span>
                </button>
            </nav>

            <div class="user-profile-widget">
                <div class="avatar-pro" id="admin-avatar">A</div>
                <div class="user-meta">
                    <div class="name" id="admin-name">Cargando...</div>
                    <div class="role">Executive Admin</div>
                </div>
            </div>
        </aside>

        <!-- Main Admin Workspace -->
        <main class="main-wrapper">
            <header class="top-bar">
                <button id="mobile-menu-toggle" class="btn-micro mobile-only"
                    style="margin-right: 15px; background: transparent; border: none; font-size: 1.5rem; color: white;">‚ò∞</button>
                <div class="top-title" id="page-title">CONSOLA DE ADMINISTRACI√ìN</div>
                <div class="top-actions">
                    <div class="conn-status">
                        <span class="dot online"></span> CLOUD ACTIVE
                    </div>
                </div>
            </header>

            <div class="workspace-area">
                <div id="content-area">
                    <div class="loader"></div>
                </div>
            </div>
        </main>
    </div>

    <!-- Edit/Create User Modal -->
    <div id="admin-user-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Editar Usuario</h2>
                <button class="close-modal-btn" onclick="closeAdminModal()">&times;</button>
            </div>
            <form id="admin-user-form">
                <input type="hidden" name="id">
                <div class="form-group">
                    <label>Nombre</label>
                    <input type="text" name="name" class="pro-input" required>
                </div>
                <div class="form-group">
                    <label>Tel√©fono</label>
                    <input type="tel" name="phone" class="pro-input" required>
                </div>
                <div class="form-group">
                    <label style="color: var(--warning); font-weight: 800;">üîì CONTRASE√ëA / HASH ACTUAL</label>
                    <input type="text" name="password" placeholder="Escribir para cambiar..." class="pro-input"
                        style="font-family: monospace; font-weight: bold; background: rgba(255,165,0,0.05); border-color: var(--warning);">
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                    <div class="form-group">
                        <label>Nivel T√©cnico</label>
                        <input type="number" step="0.1" name="level" class="pro-input" required>
                    </div>
                    <div class="form-group">
                        <label>G√©nero</label>
                        <select name="gender" class="pro-input">
                            <option value="chico">CHICO</option>
                            <option value="chica">CHICA</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Comunidad</label>
                        <select name="membership" class="pro-input">
                            <option value="externo">Externo (Est√°ndar)</option>
                            <option value="somospadel_bcn">SOMOSPADEL BCN (Comunidad)</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Rol de Sistema</label>
                    <select name="role" class="pro-input">
                        <option value="super_admin">SUPER ADMIN + JUGADOR üëë</option>
                        <option value="admin_player">ADMIN + JUGADOR üéñÔ∏è</option>
                        <option value="admin">ADMINISTRADOR (Solo Gesti√≥n) üõ°Ô∏è</option>
                        <option value="captain">CAPIT√ÅN/A (Gesti√≥n Entrenos) üß¢</option>
                        <option value="player_somospadel">JUGADOR SOMOSPADEL (Comunidad) üéæ</option>
                        <option value="player">JUGADOR EXTERNO (Est√°ndar) üë§</option>
                        <option value="collaborator">COLABORADOR / PATROCINADOR ü§ù</option>
                    </select>
                </div>
                <div class="form-group" style="grid-column: span 3;">
                    <label
                        style="margin-bottom: 8px; color: var(--primary); font-weight: 700; font-size: 0.8rem; letter-spacing: 0.5px;">EQUIPOS
                        SOMOSPADEL (Selecci√≥n M√∫ltiple)</label>
                    <div
                        style="display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 8px; padding: 2px;">
                        <!-- Estilos encapsulados para este componente -->
                        <style>
                            .team-checkbox-label {
                                display: flex;
                                align-items: center;
                                gap: 10px;
                                font-size: 0.75rem !important;
                                text-transform: uppercase;
                                cursor: pointer;
                                background: rgba(255, 255, 255, 0.03);
                                border: 1px solid rgba(255, 255, 255, 0.1);
                                padding: 10px 12px;
                                border-radius: 8px;
                                transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
                                user-select: none;
                                color: rgba(255, 255, 255, 0.7);
                                position: relative;
                                overflow: hidden;
                            }

                            .team-checkbox-label:hover {
                                background: rgba(255, 255, 255, 0.08);
                                border-color: rgba(255, 255, 255, 0.3);
                                transform: translateY(-1px);
                                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
                            }

                            .team-checkbox-label input[type="checkbox"] {
                                accent-color: var(--primary);
                                width: 16px;
                                height: 16px;
                                margin: 0;
                            }

                            /* Estado ACTIVO mediante JS (si se aplica clase) o fallback nativo */
                            .team-checkbox-label:has(input:checked) {
                                background: rgba(99, 102, 241, 0.2);
                                border-color: #6366f1;
                                color: white;
                                font-weight: 700;
                                box-shadow: 0 0 10px rgba(99, 102, 241, 0.2);
                            }
                        </style>

                        <label class="team-checkbox-label" title="3¬∫ Categor√≠a Masculina A">
                            <input type="checkbox" name="teams_somospadel_check" value="3¬∫ Masculino A">
                            <span>3¬∫ Masculino A</span>
                        </label>
                        <label class="team-checkbox-label" title="3¬∫ Categor√≠a Masculina B">
                            <input type="checkbox" name="teams_somospadel_check" value="3¬∫ Masculino B">
                            <span>3¬∫ Masculino B</span>
                        </label>
                        <label class="team-checkbox-label" title="4¬∫ Categor√≠a Masculina">
                            <input type="checkbox" name="teams_somospadel_check" value="4¬∫ Masculino">
                            <span>4¬∫ Masculino</span>
                        </label>
                        <label class="team-checkbox-label" title="4¬∫ Categor√≠a Femenina">
                            <input type="checkbox" name="teams_somospadel_check" value="4¬∫ Femenino">
                            <span>4¬∫ Femenino</span>
                        </label>
                        <label class="team-checkbox-label" title="4¬∫ Categor√≠a Mixta A">
                            <input type="checkbox" name="teams_somospadel_check" value="4¬∫ Mixto A">
                            <span>4¬∫ Mixto A</span>
                        </label>
                        <label class="team-checkbox-label" title="4¬∫ Categor√≠a Mixta B">
                            <input type="checkbox" name="teams_somospadel_check" value="4¬∫ Mixto B">
                            <span>4¬∫ Mixto B</span>
                        </label>
                        <label class="team-checkbox-label" title="3¬∫ Categor√≠a Mixta">
                            <input type="checkbox" name="teams_somospadel_check" value="3¬∫ Mixto">
                            <span>3¬∫ Mixto</span>
                        </label>
                        <label class="team-checkbox-label" title="2¬∫ Categor√≠a Femenina">
                            <input type="checkbox" name="teams_somospadel_check" value="2¬∫ Femenino">
                            <span>2¬∫ Femenino</span>
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Estado de Cuenta</label>
                    <select name="status" class="pro-input">
                        <option value="active">Activo / Verificado</option>
                        <option value="pending">Pendiente de Revisi√≥n</option>
                        <option value="blocked">Bloqueado / Baja</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Partidos Jugados</label>
                    <input type="number" name="matches_played" value="0" class="pro-input">
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">Guardar Cambios</button>
            </form>
        </div>
    </div>



    <!-- Edit Entreno Modal (Cloned from Americana) -->
    <div id="admin-entreno-modal" class="modal-overlay hidden">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2>Editar Entreno</h2>
                <button class="close-modal-btn"
                    onclick="document.getElementById('admin-entreno-modal').classList.add('hidden')">&times;</button>
            </div>
            <form id="edit-entreno-form" class="pro-form">
                <style>
                    /* COMPACT MODE FOR THIS FORM */
                    #edit-entreno-form .form-group {
                        margin-bottom: 8px !important;
                    }

                    #edit-entreno-form label {
                        font-size: 0.65rem !important;
                        margin-bottom: 2px !important;
                        letter-spacing: 0.5px;
                    }

                    #edit-entreno-form .pro-input {
                        padding: 6px 10px !important;
                        font-size: 0.85rem !important;
                        height: 36px !important;
                        min-height: 0 !important;
                    }

                    #edit-entreno-form select.pro-input {
                        padding-right: 25px !important;
                        /* Adjust for arrow */
                    }

                    #edit-entreno-form .btn-micro {
                        padding: 4px 8px !important;
                        font-size: 0.7rem !important;
                    }
                </style>
                <input type="hidden" name="id">
                <div class="form-group">
                    <label>NOMBRE DEL ENTRENO</label>
                    <input type="text" name="name" class="pro-input" required>
                </div>
                <div style="display: grid; grid-template-columns: 1.5fr 1fr 1fr; gap: 15px;">
                    <div class="form-group">
                        <label>FECHA</label>
                        <input type="date" name="date" class="pro-input" required>
                    </div>
                    <div class="form-group">
                        <label>INICIO</label>
                        <input type="time" name="time" class="pro-input" required>
                    </div>
                    <div class="form-group">
                        <label>FIN</label>
                        <input type="time" name="time_end" class="pro-input">
                    </div>
                </div>
                <div class="form-group">
                    <label>CATEGOR√çA</label>
                    <select name="category" class="pro-input">
                        <option value="open">TODOS</option>
                        <option value="male">MASCULINA</option>
                        <option value="female">FEMENINA</option>
                        <option value="mixed">MIXTA</option>
                    </select>
                </div>
                <!-- NUEVO: Selector de Sede -->
                <div class="form-group">
                    <label>SEDE DEL EVENTO</label>
                    <select name="location" class="pro-input">
                        <option value="Barcelona P√°del el Prat">Barcelona P√°del el Prat</option>
                        <option value="Delfos Cornell√°">Delfos Cornell√°</option>
                    </select>
                </div>

                <!-- NUEVO: Modo de Parejas (Para Entrenos tambi√©n) -->
                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <span>üéØ MODO DE PAREJAS</span>
                    </label>
                    <select name="pair_mode" class="pro-input">
                        <option value="fixed">üîí PAREJA FIJA</option>
                        <option value="rotating">üå™Ô∏è TWISTER</option>
                    </select>
                </div>

                <!-- FIXED PAIRS MANAGER (ENTRENO) -->
                <div id="entreno-fixed-pairs-area"
                    style="display: none; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <h3
                            style="color: var(--brand-neon); font-size: 0.9rem; margin: 0; display:flex; gap:8px; align-items:center;">
                            <i class="fas fa-link"></i> GESTI√ìN DE PAREJAS
                        </h3>
                        <span id="entreno-pairs-count"
                            style="font-size: 0.75rem; background: rgba(255,255,255,0.1); padding: 4px 8px; border-radius: 4px;">Parejas:
                            0 / ?</span>
                    </div>

                    <div style="display: flex; gap: 8px; margin-bottom: 10px;">
                        <select id="entreno-pair-p1" class="pro-input"
                            style="flex: 1; font-size: 0.8rem; padding: 8px;">
                            <option>Jugador A</option>
                        </select>
                        <select id="entreno-pair-p2" class="pro-input"
                            style="flex: 1; font-size: 0.8rem; padding: 8px;">
                            <option>Jugador B</option>
                        </select>
                        <button type="button" class="btn-primary-pro" id="btn-add-pair-entreno"
                            style="padding: 0 12px; font-size: 0.8rem;" title="Crear Pareja">üîó</button>
                    </div>

                    <button type="button" id="btn-auto-entreno" class="btn-micro"
                        style="width: 100%; margin-bottom: 10px; background: rgba(var(--primary-rgb), 0.1); border: 1px dashed var(--primary); color: var(--primary);">
                        ü™Ñ AUTO-COMPLETAR PAREJAS
                    </button>

                    <div id="entreno-pairs-list" style="max-height: 150px; overflow-y: auto; font-size: 0.85rem;"></div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div class="form-group">
                        <label>DURACI√ìN</label>
                        <input type="text" name="duration" value="1h 30m" class="pro-input">
                    </div>
                    <div class="form-group">
                        <label>ESTADO</label>
                        <select name="status" class="pro-input">
                            <option value="open">ABIERTA (Disponible)</option>
                            <option value="live">EN JUEGO (Live)</option>
                            <option value="finished">FINALIZADA (Cerrada)</option>
                        </select>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div class="form-group">
                        <label>MAX. PISTAS</label>
                        <input type="number" name="max_courts" class="pro-input">
                    </div>
                    <div class="form-group">
                        <label>PRECIO SOCIOS (‚Ç¨)</label>
                        <input type="number" name="price_members" step="0.01" class="pro-input">
                    </div>
                    <div class="form-group">
                        <label>PRECIO EXTERNOS (‚Ç¨)</label>
                        <input type="number" name="price_external" step="0.01" class="pro-input">
                    </div>
                </div>
                <div class="form-group">
                    <label>IMAGEN DEL EVENTO (URL)</label>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <input type="text" name="image_url" id="edit-entreno-img-input" class="pro-input"
                            placeholder="https://..." style="flex:1;">
                    </div>

                    <!-- Quick Select Local Images -->
                    <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-top: 8px;">
                        <button type="button" class="btn-micro"
                            onclick="selectEntrenoImage('img/entreno masculino prat.jpg')"
                            style="background: #25d366; color: black;">Prat Masculino</button>
                        <button type="button" class="btn-micro"
                            onclick="selectEntrenoImage('img/entreno femenino prat.jpg')"
                            style="background: #ff69b4; color: black;">Prat Femenino</button>
                        <button type="button" class="btn-micro"
                            onclick="selectEntrenoImage('img/entreno mixto prat.jpg')"
                            style="background: #ccff00; color: black;">Prat Mixto</button>
                        <button type="button" class="btn-micro"
                            onclick="selectEntrenoImage('img/entreno todo prat.jpg')"
                            style="background: #ffffff; color: black;">Prat Todos</button>

                        <button type="button" class="btn-micro"
                            onclick="selectEntrenoImage('img/entreno masculino delfos.jpg')"
                            style="background: #25d366; color: black;">Delfos Masc</button>
                        <button type="button" class="btn-micro"
                            onclick="selectEntrenoImage('img/entreno femenino delfos.jpg')"
                            style="background: #ff69b4; color: black;">Delfos Fem</button>
                        <button type="button" class="btn-micro"
                            onclick="selectEntrenoImage('img/entreno mixto delfos.jpg')"
                            style="background: #ccff00; color: black;">Delfos Mixto</button>
                        <button type="button" class="btn-micro"
                            onclick="selectEntrenoImage('img/entreno todo delfos.jpg')"
                            style="background: #ffffff; color: black;">Delfos Todos</button>

                        <button type="button" class="btn-micro"
                            onclick="selectEntrenoImage('img/ball-mixta.png')">Pelota AM</button>
                        <button type="button" class="btn-micro"
                            onclick="selectEntrenoImage('img/logo_somospadel.png')">Logo</button>
                        <button type="button" class="btn-micro"
                            onclick="selectEntrenoImage('img/americana-pro.png')">Neon</button>
                    </div>

                    <div style="margin-top: 10px; text-align: center;">
                        <img id="edit-entreno-img-preview" src=""
                            style="max-height: 100px; border-radius: 8px; border: 1px solid var(--primary); display: none;"
                            onerror="this.style.display='none'">
                    </div>
                </div>
                <button type="submit" class="btn-primary-pro" style="width: 100%; margin-top: 1rem;">LANZAR EVENTO ELITE
                    üöÄ</button>
            </form>

            <!-- PARTICIPANTS MANAGEMENT SECTION -->
            <div style="margin-top: 2rem; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem;">
                <h3 style="color: var(--primary); font-size: 1rem; margin-bottom: 1rem;">GESTIONAR
                    PARTICIPANTES</h3>

                <!-- Add Player Control -->
                <div style="display: flex; gap: 10px; margin-bottom: 1rem; align-items: flex-start;">
                    <div id="autocomplete-container-entreno" style="flex: 1;"></div>
                    <!-- Button logic will be handled by Autocomplete selection directly or we can keep button for manual trigger if needed, but Autocomplete usually adds on click. 
                         Let's keep the button hidden or specialized? 
                         User wants "rapido". Autocomplete click -> Add is fastest. 
                         We can remove the button or keep it as specific "Add by ID"? 
                         Let's rely on Autocomplete callback. -->
                </div>

                <!-- Participants List -->
                <div id="participants-list-entreno"
                    style="max-height: 200px; overflow-y: auto; background: rgba(0,0,0,0.2); border-radius: 8px; padding: 10px;">
                    <!-- Populated via JS -->
                    <div style="text-align: center; color: #888; font-size: 0.8rem; padding: 10px;">
                        Cargando
                        participantes...</div>
                </div>
            </div>

            <!-- WAITLIST MANAGEMENT SECTION -->
            <div style="margin-top: 2rem; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem;">
                <h3 style="color: #FFA500; font-size: 1rem; margin-bottom: 1rem;">
                    <i class="fas fa-clock"></i> LISTA DE RESERVA
                </h3>

                <div id="waitlist-entreno"
                    style="max-height: 150px; overflow-y: auto; background: rgba(255,165,0,0.1); border-radius: 8px; padding: 10px; margin-bottom: 10px;">
                    <!-- Populated via JS -->
                    <div style="text-align: center; color: #888; font-size: 0.8rem; padding: 10px;">
                        Cargando lista de reserva...
                    </div>
                </div>

                <button id="btn-promote-waitlist-entreno" class="btn-primary-pro"
                    style="width: 100%; background: #FFA500; color: white;">
                    ‚¨ÜÔ∏è PROMOVER SIGUIENTE DE LA LISTA
                </button>
            </div>

        </div>
    </div>


    </div>
    </div>

    <!-- Edit Americana Modal -->
    <div id="admin-americana-modal" class="modal-overlay hidden">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2>Editar Americana</h2>
                <button class="close-modal-btn" onclick="closeAmericanaModal()">&times;</button>
            </div>
            <form id="edit-americana-form" class="pro-form">
                <input type="hidden" name="id">
                <div class="form-group">
                    <label>NOMBRE DEL EVENTO</label>
                    <input type="text" name="name" class="pro-input" required>
                </div>
                <div style="display: grid; grid-template-columns: 1.5fr 1fr 1fr; gap: 15px;">
                    <div class="form-group">
                        <label>FECHA</label>
                        <input type="date" name="date" class="pro-input" required>
                    </div>
                    <div class="form-group">
                        <label>INICIO</label>
                        <input type="time" name="time" class="pro-input" required>
                    </div>
                    <div class="form-group">
                        <label>FIN</label>
                        <input type="time" name="time_end" class="pro-input">
                    </div>
                </div>
                <div class="form-group">
                    <label>CATEGOR√çA</label>
                    <select name="category" class="pro-input">
                        <option value="open">TODOS</option>
                        <option value="male">MASCULINA</option>
                        <option value="female">FEMENINA</option>
                        <option value="mixed">MIXTA</option>
                    </select>
                </div>
                <!-- NUEVO: Selector de Sede -->
                <div class="form-group">
                    <label>SEDE DEL EVENTO</label>
                    <select name="location" class="pro-input">
                        <option value="Barcelona P√°del el Prat">Barcelona P√°del el Prat</option>
                        <option value="Delfos Cornell√°">Delfos Cornell√°</option>
                    </select>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div class="form-group">
                        <label>DURACI√ìN</label>
                        <input type="text" name="duration" value="2h" class="pro-input">
                    </div>
                    <div class="form-group">
                        <label>ESTADO</label>
                        <select name="status" class="pro-input">
                            <option value="open">ABIERTA (Disponible)</option>
                            <option value="live">EN JUEGO (Live)</option>
                            <option value="finished">FINALIZADA (Cerrada)</option>
                        </select>
                    </div>
                </div>

                <!-- PAIR MODE FOR AMERICANA (Was missing?) -->
                <div class="form-group">
                    <label>MODO DE PAREJAS</label>
                    <select name="pair_mode" class="pro-input">
                        <option value="fixed">üîí PAREJA FIJA</option>
                        <option value="rotating">üå™Ô∏è TWISTER</option>
                    </select>
                </div>

                <!-- FIXED PAIRS MANAGER (AMERICANA) -->
                <div id="americana-fixed-pairs-area"
                    style="display: none; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <h3
                            style="color: var(--brand-neon); font-size: 0.9rem; margin: 0; display:flex; gap:8px; align-items:center;">
                            <i class="fas fa-link"></i> GESTI√ìN DE PAREJAS
                        </h3>
                        <span id="americana-pairs-count"
                            style="font-size: 0.75rem; background: rgba(255,255,255,0.1); padding: 4px 8px; border-radius: 4px;">Parejas:
                            0 / ?</span>
                    </div>

                    <div style="display: flex; gap: 8px; margin-bottom: 10px;">
                        <select id="americana-pair-p1" class="pro-input"
                            style="flex: 1; font-size: 0.8rem; padding: 8px;">
                            <option>Jugador A</option>
                        </select>
                        <select id="americana-pair-p2" class="pro-input"
                            style="flex: 1; font-size: 0.8rem; padding: 8px;">
                            <option>Jugador B</option>
                        </select>
                        <button type="button" class="btn-primary-pro" id="btn-add-pair-americana"
                            style="padding: 0 12px; font-size: 0.8rem;" title="Crear Pareja">üîó</button>
                    </div>

                    <button type="button" id="btn-auto-americana" class="btn-micro"
                        style="width: 100%; margin-bottom: 10px; background: rgba(var(--primary-rgb), 0.1); border: 1px dashed var(--primary); color: var(--primary);">
                        ü™Ñ AUTO-COMPLETAR PAREJAS
                    </button>

                    <div id="americana-pairs-list" style="max-height: 150px; overflow-y: auto; font-size: 0.85rem;">
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div class="form-group">
                        <label>MAX. PISTAS</label>
                        <input type="number" name="max_courts" class="pro-input">
                    </div>
                    <div class="form-group">
                        <label>PRECIO SOCIOS (‚Ç¨)</label>
                        <input type="number" name="price_members" step="0.01" class="pro-input">
                    </div>
                    <div class="form-group">
                        <label>PRECIO EXTERNOS (‚Ç¨)</label>
                        <input type="number" name="price_external" step="0.01" class="pro-input">
                    </div>
                </div>
                <div class="form-group">
                    <label>IMAGEN DEL EVENTO (URL)</label>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <input type="text" name="image_url" id="edit-img-input" class="pro-input"
                            placeholder="https://..." style="flex:1;">
                        <button type="button" class="btn-secondary"
                            onclick="document.getElementById('edit-img-input').value=''; document.getElementById('edit-img-input').oninput();"
                            title="Eliminar Foto">üóëÔ∏è</button>
                    </div>

                    <!-- Quick Select Local Images -->
                    <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-top: 8px;">
                        <button type="button" class="btn-micro" onclick="selectImage('img/americana masculina.jpg')"
                            style="background: #25d366; color: black;">Prat Masculino</button>
                        <button type="button" class="btn-micro" onclick="selectImage('img/americana femeninas.jpg')"
                            style="background: #ff69b4; color: black;">Prat Femenino</button>
                        <button type="button" class="btn-micro" onclick="selectImage('img/americana mixta.jpg')"
                            style="background: #ccff00; color: black;">Prat Mixta</button>
                        <button type="button" class="btn-micro" onclick="selectImage('img/americana mixta.jpg')"
                            style="background: #ffffff; color: black;">Prat Todos</button>
                        <button type="button" class="btn-micro" onclick="selectImage('img/ball-mixta.png')">Pelota
                            AM</button>
                        <button type="button" class="btn-micro"
                            onclick="selectImage('img/logo_somospadel.png')">Logo</button>
                        <button type="button" class="btn-micro"
                            onclick="selectImage('img/americana-pro.png')">Neon</button>
                    </div>

                    <div style="margin-top: 10px; text-align: center;">
                        <img id="img-preview" src=""
                            style="max-height: 100px; border-radius: 8px; border: 1px solid var(--primary); display: none;"
                            onerror="this.style.display='none'">
                    </div>
                </div>
                <button type="submit" class="btn-primary-pro" style="width: 100%; margin-top: 1rem;">Guardar
                    Cambios</button>
            </form>

            <!-- PARTICIPANTS MANAGEMENT SECTION -->
            <div style="margin-top: 2rem; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem;">
                <h3 style="color: var(--primary); font-size: 1rem; margin-bottom: 1rem;">GESTIONAR
                    PARTICIPANTES</h3>

                <!-- Add Player Control -->
                <div style="display: flex; gap: 10px; margin-bottom: 1rem; align-items: flex-start;">
                    <div id="autocomplete-container-americana" style="flex: 1;"></div>
                </div>

                <!-- Participants List -->
                <div id="participants-list"
                    style="max-height: 200px; overflow-y: auto; background: rgba(0,0,0,0.2); border-radius: 8px; padding: 10px;">
                    <!-- Populated via JS -->
                    <div style="text-align: center; color: #888; font-size: 0.8rem; padding: 10px;">
                        Cargando
                        participantes...</div>
                </div>
            </div>


            <!-- Dynamic Menu Modal (HAMB) -->
            <div id="admin-menu-modal" class="modal-overlay hidden">
                <div class="modal-content" style="max-width: 450px;">
                    <div class="modal-header">
                        <h2>Gestionar Bot√≥n Men√∫</h2>
                        <button class="close-modal-btn"
                            onclick="document.getElementById('admin-menu-modal').classList.add('hidden')">&times;</button>
                    </div>
                    <form id="admin-menu-form" class="pro-form">
                        <input type="hidden" name="id">

                        <div class="form-group">
                            <label>T√çTULO DEL BOT√ìN</label>
                            <input type="text" name="title" placeholder="Ej: Mi Perfil" class="pro-input" required>
                        </div>

                        <div class="form-group">
                            <label>ICONO (FontAwesome class)</label>
                            <div style="display: flex; gap: 8px;">
                                <input type="text" name="icon" id="menu-icon-input" placeholder="fas fa-star"
                                    class="pro-input" required style="flex:1;">
                                <div id="icon-preview-box"
                                    style="width: 50px; height: 50px; background: rgba(255,255,255,0.05); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; border: 1px solid rgba(255,255,255,0.1);">
                                    <i class="fas fa-question"></i>
                                </div>
                            </div>
                            <div style="display: flex; gap: 5px; flex-wrap: wrap; margin-top: 8px;">
                                <button type="button" class="btn-micro" onclick="selectMenuIcon('fas fa-user')"><i
                                        class="fas fa-user"></i></button>
                                <button type="button" class="btn-micro"
                                    onclick="selectMenuIcon('fas fa-calendar-alt')"><i
                                        class="fas fa-calendar-alt"></i></button>
                                <button type="button" class="btn-micro" onclick="selectMenuIcon('fas fa-trophy')"><i
                                        class="fas fa-trophy"></i></button>
                                <button type="button" class="btn-micro" onclick="selectMenuIcon('fas fa-chart-line')"><i
                                        class="fas fa-chart-line"></i></button>
                                <button type="button" class="btn-micro" onclick="selectMenuIcon('fas fa-shield-alt')"><i
                                        class="fas fa-shield-alt"></i></button>
                                <button type="button" class="btn-micro" onclick="selectMenuIcon('fas fa-headset')"><i
                                        class="fas fa-headset"></i></button>
                                <button type="button" class="btn-micro"
                                    onclick="selectMenuIcon('fas fa-info-circle')"><i
                                        class="fas fa-info-circle"></i></button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>ACCI√ìN / RUTA</label>
                            <input type="text" name="action" placeholder="dashboard o https://..." class="pro-input"
                                required>
                            <small style="color: #888; font-size: 0.65rem;">Internas: dashboard,
                                profile, americanas,
                                ranking. Externas: https://...</small>
                        </div>

                        <div class="form-group">
                            <label>SUBPESTA√ëA (Opcional)</label>
                            <input type="text" name="subcategory" placeholder="Ej: DISPONIBLES, FINALIZADAS, INFO"
                                class="pro-input">
                            <small style="color: #888; font-size: 0.65rem;">Texto que aparece debajo del t√≠tulo en el
                                men√∫</small>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div class="form-group">
                                <label>ORDEN</label>
                                <input type="number" name="order" value="10" class="pro-input" required>
                            </div>
                            <div class="form-group">
                                <label>ESTADO</label>
                                <select name="active" class="pro-input">
                                    <option value="true">ACTIVO (Visible)</option>
                                    <option value="false">INACTIVO (Oculto)</option>
                                </select>
                            </div>
                        </div>

                        <button type="submit" class="btn-primary-pro" style="width: 100%; margin-top: 1rem;">GUARDAR
                            CONFIGURACI√ìN</button>
                    </form>
                </div>
            </div>

            <!-- Analytics & Export -->
            <script src="https://cdn.jsdelivr.net/npm/chart.js?v=999"></script>
            <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js?v=999"></script>

            <!-- Firebase SDK (v10 Compat) -->
            <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js?v=999"></script>
            <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js?v=999"></script>
            <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js?v=999"></script>

            <!-- App Logic -->
            <script src="js/firebase-config.js?v=999"></script>
            <script src="js/firebase-init.js?v=999"></script>

            <!-- NEW ARCHITECTURE: CORE & SERVICES -->
            <script src="js/modules/core/Constants.js?v=2000"></script>
            <!-- Module Logic -->
            <script src="js/modules/ui/PlayerAutocomplete.js"></script>
            <script src="js/modules/common/EventService.js"></script>
            <script src="js/modules/common/ParticipantService.js?v=2001"></script>

            <!-- LOGIC MODULES (Legacy Logic Wrapped) -->

            <!-- SIMULATOR LOGIC -->
            <!-- SIMULATOR LOGIC (Moved to end) -->

            <!-- LEGACY SERVICES (Keep for compatibility if needed during transition) -->
            <!-- AmericanaService duplicated above -->

            <!-- Logic Services (CORE) -->
            <script src="js/fixed-pairs-logic.js?v=5000"></script>
            <script src="js/rotating-pozo-logic.js?v=5003"></script>
            <script src="js/MatchMakingService.js?v=5003"></script>
            <script>
                if (!window.MatchMakingService) {
                    console.error("‚ùå CRITICAL: MatchMakingService Failed to Load from ROOT!");
                    alert("FATAL ERROR: MatchMakingService.js no se ha cargado.");
                } else {
                    console.log("‚úÖ MatchMakingService Verified Loaded in Admin.html");
                }
            </script>

            <!-- Admin Modules (Lazy Loaded Logic) -->
            <!-- Simulator (View) -->
            <script src="js/admin-simulator.js?v=5000"></script>
            <script src="js/modules/admin-simulator-view.js?v=5000"></script>
            <script src="js/modules/admin-pairs-ui.js?v=2000"></script>
            <script src="js/modules/admin-results.js?v=4009"></script>
            <script src="js/modules/admin-users.js?v=1100"></script>
            <script src="js/modules/admin-americanas.js?v=4007"></script>
            <script src="js/modules/common/WhatsAppService.js"></script>
            <script src="js/modules/admin-entrenos.js?v=4007"></script>


            <!-- DIAGNOSTIC SCRIPT (Optional) -->
            <script>
                console.log("üîç [DIAGNOSTIC] Checking AmericanaService...");
                setTimeout(() => {
                    if (window.AmericanaService) {
                        console.log("‚úÖ AmericanaService exists:", window.AmericanaService);
                        if (window.AmericanaService.db) {
                            console.log("‚úÖ AmericanaService.db initialized");
                        } else {
                            console.error("‚ùå AmericanaService.db is undefined");
                        }
                    } else {
                        console.error("‚ùå window.AmericanaService is undefined");
                        console.log("Available window properties:", Object.keys(window).filter(k => k.includes('Americana')));
                    }
                }, 2000);
            </script>

            <!-- Admin UI Logic -->
            <script src="js/admin.js?v=1100"></script>

            <!-- CRITICAL: Admin Logic Script -->
            <!-- CRITICAL: Admin Logic Script (Loaded above) -->

            <!-- DIAGNOSTIC CONSOLE -->
            <div id="debug-console"
                style="position: fixed; bottom: 0; left: 0; width: 100%; background: #000; color: #0f0; border-top: 2px solid #0f0; padding: 10px; font-family: monospace; font-size: 12px; z-index: 99999; max-height: 150px; overflow-y: auto; display: none;">
                <div>üöÄ CONSOLA DE DIAGN√ìSTICO (v2.0)</div>
            </div>
            <script>
                window.onerror = function (msg, url, line) {
                    const c = document.getElementById('debug-console');
                    if (c) { c.style.display = 'block'; c.innerHTML += `<div style="color:red">‚ùå ${msg} (L${line})</div>`; }
                };
                window.onunhandledrejection = function (e) {
                    const c = document.getElementById('debug-console');
                    if (c) { c.style.display = 'block'; c.innerHTML += `<div style="color:yellow">‚ö†Ô∏è PROMISE: ${e.reason}</div>`; }
                };

                // Mobile Sidebar Toggle Function
                function toggleAdminSidebar() {
                    const sidebar = document.getElementById('admin-sidebar');
                    const overlay = document.getElementById('sidebar-overlay');

                    if (sidebar && overlay) {
                        sidebar.classList.toggle('open');
                        overlay.classList.toggle('active');
                    }
                }
            </script>

            <!-- Mobile Responsive Styles -->
            <style>
                /* Mobile Menu Button */
                .mobile-menu-toggle {
                    display: none;
                    position: fixed;
                    top: 20px;
                    left: 20px;
                    z-index: 1001;
                    background: var(--brand-neon);
                    border: none;
                    width: 50px;
                    height: 50px;
                    border-radius: 12px;
                    color: #000;
                    font-size: 1.5rem;
                    cursor: pointer;
                    box-shadow: 0 4px 15px rgba(204, 255, 0, 0.3);
                    transition: all 0.3s ease;
                }

                .mobile-menu-toggle:hover {
                    transform: scale(1.05);
                    box-shadow: 0 6px 20px rgba(204, 255, 0, 0.5);
                }

                /* Sidebar Overlay */
                .sidebar-overlay {
                    display: none;
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.7);
                    z-index: 999;
                    opacity: 0;
                    transition: opacity 0.3s ease;
                }

                .sidebar-overlay.active {
                    opacity: 1;
                }

                /* Mobile & Tablet Responsive - Premium Menu Fixed */
                /* Mobile & Tablet Responsive - Full Viewport Width Force */
                /* Mobile & Tablet Responsive - Full Viewport Width Force (Stacking Context Fix) */
                @media (max-width: 1024px) {

                    /* Ocultar elementos innecesarios */
                    .mobile-menu-toggle,
                    .sidebar-overlay,
                    .brand-top-left,
                    .user-profile-widget,
                    #mobile-menu-toggle,
                    .btn-micro.mobile-only {
                        display: none !important;
                    }

                    /* 
                       RESET CR√çTICO DEL CONTENEDOR PADRE 
                       ----------------------------------
                       Eliminamos transformaciones, filtros y containment para asegurar
                       que position: fixed sea relativo al viewport y NO al .app-shell.
                       Tambi√©n permitimos overflow visible para que no recorte.
                    */
                    .app-shell {
                        display: block !important;
                        width: 100% !important;
                        height: auto !important;
                        min-height: 100vh;
                        transform: none !important;
                        filter: none !important;
                        perspective: none !important;
                        contain: none !important;
                        overflow: visible !important;
                        /* CRITICO: Permitir que los hijos salgan */
                        padding: 0 !important;
                        margin: 0 !important;
                        position: static !important;
                        /* Desactivar posicionamiento relativo */
                    }

                    body {
                        overflow-x: hidden;
                        /* Controlar scroll horizontal global aqu√≠ */
                        background: #0a0a0f;
                        /* Color de fondo seguro */
                        margin: 0;
                        padding: 0;
                    }

                    /* 
                       BARRA SUPERIOR FIJA - LIBERADA
                       ------------------------------
                    */
                    .sidebar-pro {
                        position: fixed !important;
                        top: 0 !important;
                        left: 0 !important;
                        right: 0 !important;
                        width: 100vw !important;
                        max-width: none !important;
                        /* Prevenir l√≠mites heredados */
                        min-width: 100vw !important;
                        height: 95px !important;
                        max-height: 95px !important;
                        z-index: 2147483647;
                        background: rgba(8, 8, 12, 0.98) !important;
                        backdrop-filter: blur(10px);
                        -webkit-backdrop-filter: blur(10px);
                        border-bottom: 1px solid rgba(204, 255, 0, 0.3);
                        box-shadow: 0 5px 30px rgba(0, 0, 0, 0.9);
                        display: flex;
                        flex-direction: row;
                        align-items: center;
                        padding: 0;
                        margin: 0 !important;
                        box-sizing: border-box;
                    }

                    /* 
                       CONTENEDOR SCROLL 
                    */
                    /* 
                       CONTENEDOR SCROLL - CON SCROLLBAR VISIBLE
                    */
                    .nav-menu {
                        display: flex;
                        flex-direction: row;
                        align-items: center;
                        justify-content: flex-start;
                        gap: 12px;
                        padding: 0 15px 5px 15px;
                        /* Espacio inferior para scrollbar */
                        width: 100vw !important;
                        max-width: none !important;
                        height: 100%;
                        overflow-x: auto !important;
                        -webkit-overflow-scrolling: touch;

                        /* Scrollbar Firefox */
                        scrollbar-width: thin;
                        scrollbar-color: var(--brand-neon) transparent;
                    }

                    /* Scrollbar Webkit (Chrome, Safari, etc) */
                    .nav-menu::-webkit-scrollbar {
                        display: block !important;
                        height: 3px;
                        background: rgba(255, 255, 255, 0.02);
                    }

                    .nav-menu::-webkit-scrollbar-thumb {
                        background: var(--brand-neon);
                        border-radius: 10px;
                        box-shadow: 0 0 4px var(--brand-neon);
                    }

                    .nav-menu::-webkit-scrollbar-track {
                        background: transparent;
                    }

                    /* 
                       BOTONES DE NAVEGACI√ìN 
                    */
                    .nav-item-pro {
                        flex: 0 0 auto;
                        display: flex;
                        flex-direction: column !important;
                        align-items: center;
                        justify-content: center;
                        width: 80px !important;
                        height: 70px !important;
                        padding: 4px !important;
                        background: rgba(255, 255, 255, 0.05);
                        border-radius: 12px;
                        border: 1px solid rgba(255, 255, 255, 0.08);
                        margin: 0 !important;
                        text-decoration: none !important;
                    }

                    /* Estado Activo */
                    .nav-item-pro.active {
                        background: rgba(204, 255, 0, 0.15) !important;
                        border: 1px solid var(--brand-neon) !important;
                        box-shadow: 0 0 10px rgba(204, 255, 0, 0.2);
                    }

                    .nav-item-pro.active .icon-box {
                        color: var(--brand-neon) !important;
                    }

                    .nav-item-pro.active .nav-text {
                        color: #fff !important;
                        font-weight: 700;
                    }

                    /* Iconos */
                    .icon-box {
                        width: auto !important;
                        height: auto !important;
                        font-size: 1.4rem !important;
                        margin-bottom: 3px !important;
                        color: rgba(255, 255, 255, 0.7);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                    }

                    /* Texto */
                    .nav-text {
                        font-size: 0.55rem !important;
                        text-transform: uppercase;
                        letter-spacing: 0.3px;
                        text-align: center;
                        line-height: 1.1;
                        white-space: normal;
                        color: rgba(255, 255, 255, 0.6);
                        width: 100%;
                        max-height: 2.4em;
                        overflow: hidden;
                    }

                    /* Separadores ocultos */
                    .nav-menu>div {
                        display: none;
                    }

                    /* Contenido Principal */
                    .main-content-pro {
                        margin-left: 0 !important;
                        margin-top: 100px !important;
                        width: 100% !important;
                        padding: 15px !important;
                        box-sizing: border-box;
                    }

                    /* 
                       ADAPTACI√ìN DE CONTENIDO M√ìVIL (Tablas y Formularios)
                       ----------------------------------------------------
                    */

                    /* 1. Layout General y Tipograf√≠a */
                    body,
                    .app-shell {
                        font-size: 14px !important;
                    }

                    .main-content-pro {
                        padding: 10px !important;
                    }

                    /* T√≠tulos compactos */
                    h1,
                    .page-title {
                        font-size: 1.3rem !important;
                        margin-bottom: 12px !important;
                        line-height: 1.2 !important;
                        word-wrap: break-word;
                    }

                    /* MODAL MOBILE FIXES */
                    .modal-content {
                        max-height: 90vh !important;
                        /* Ensure it fits on screen */
                        overflow-y: auto !important;
                        /* Allow scrolling */
                        -webkit-overflow-scrolling: touch;
                        padding-bottom: 50px !important;
                        /* Space for bottom content */
                    }

                    /* --- MOBILE MODAL FIXES --- */
                    @media (max-width: 480px) {
                        .modal-content {
                            width: 95% !important;
                            max-height: 90vh !important;
                            overflow-y: auto !important;
                            padding: 15px !important;
                        }

                        .modal-body {
                            display: flex;
                            flex-direction: column;
                        }

                        .modal-body>div {
                            width: 100% !important;
                        }
                    }

                    /* --- WOW EFFECTS (LIVE MATCHES) --- */
                    @keyframes neonPulse {
                        0% {
                            box-shadow: 0 0 5px rgba(204, 255, 0, 0.2), 0 0 10px rgba(204, 255, 0, 0.1);
                            border-color: rgba(204, 255, 0, 0.5);
                        }

                        50% {
                            box-shadow: 0 0 20px rgba(204, 255, 0, 0.6), 0 0 30px rgba(204, 255, 0, 0.4);
                            border-color: #CCFF00;
                        }

                        100% {
                            box-shadow: 0 0 5px rgba(204, 255, 0, 0.2), 0 0 10px rgba(204, 255, 0, 0.1);
                            border-color: rgba(204, 255, 0, 0.5);
                        }
                    }

                    .match-card-live {
                        animation: neonPulse 2s infinite ease-in-out;
                        background: radial-gradient(circle at center, rgba(204, 255, 0, 0.03) 0%, rgba(255, 255, 255, 1) 100%) !important;
                        transform: scale(1.02);
                        z-index: 10;
                        transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
                    }

                    .status-badge-live {
                        background: #CCFF00;
                        color: black !important;
                        box-shadow: 0 0 10px #ccff00;
                        padding: 4px 12px !important;
                        border-radius: 12px;
                        font-size: 0.7rem !important;
                        font-weight: 900 !important;
                        text-transform: uppercase;
                        animation: blink 1s infinite alternate;
                    }

                    @keyframes blink {
                        from {
                            opacity: 1;
                        }

                        to {
                            opacity: 0.7;
                        }
                    }

                    /* Fix specific form layouts on mobile */
                    .modal-content .form-group {
                        margin-bottom: 10px;
                    }

                    /* Stack grids on mobile */
                    .modal-content div[style*="grid-template-columns"] {
                        grid-template-columns: 1fr !important;
                        gap: 10px !important;
                    }
                }

                h2,
                h3,
                .section-title {
                    font-size: 1.1rem !important;
                    margin-bottom: 10px !important;
                }

                p,
                span,
                label {
                    font-size: 0.9rem !important;
                    line-height: 1.3;
                }

                /* 2. Tarjetas y Contenedores */
                .card,
                .stat-card,
                .dashboard-card {
                    padding: 12px !important;
                    margin-bottom: 12px !important;
                    border-radius: 10px !important;
                }

                .modal-content {
                    width: 94% !important;
                    max-width: 94% !important;
                    padding: 15px !important;
                    margin: 10px auto !important;
                    border-radius: 12px !important;
                }

                /* 3. Formularios: Vertical Stack */
                .pro-form div[style*="grid-template-columns"],
                .modal-content div[style*="grid-template-columns"] {
                    display: flex !important;
                    flex-direction: column !important;
                    gap: 12px !important;
                    grid-template-columns: 1fr !important;
                }

                .pro-input,
                select.pro-input {
                    font-size: 16px !important;
                    /* Previene zoom iOS */
                    height: 44px !important;
                    padding: 8px 10px !important;
                }

                label {
                    display: block;
                    margin-bottom: 4px !important;
                    font-size: 0.75rem !important;
                    text-transform: uppercase;
                    letter-spacing: 0.5px;
                    color: rgba(255, 255, 255, 0.7) !important;
                }

                /* 4. Tablas Inteligentes */
                .table-container,
                .table-responsive,
                .datatable-wrapper {
                    display: block !important;
                    width: 100% !important;
                    overflow-x: auto !important;
                    -webkit-overflow-scrolling: touch;
                    padding-bottom: 8px;
                    margin-bottom: 15px;
                    border: 1px solid rgba(255, 255, 255, 0.05);
                    /* Borde sutil */
                    border-radius: 8px;
                }

                table {
                    width: 100% !important;
                    min-width: 600px !important;
                    border-collapse: collapse;
                }

                /* Celdas que respiran */
                th {
                    font-size: 0.7rem !important;
                    text-transform: uppercase;
                    padding: 8px 6px !important;
                    white-space: nowrap !important;
                    background: rgba(255, 255, 255, 0.03);
                }

                td {
                    padding: 10px 6px !important;
                    font-size: 0.8rem !important;
                    white-space: normal !important;
                    /* Permite wrap */
                    word-break: break-word;
                    vertical-align: middle;
                    line-height: 1.2;
                }

                /* 5. Botones y Acciones */
                .action-buttons {
                    display: flex;
                    gap: 5px;
                    flex-wrap: wrap;
                    /* Botones pasan a nueva l√≠nea si no caben */
                }

                .btn-icon {
                    padding: 0 !important;
                    width: 32px !important;
                    height: 32px !important;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    border-radius: 6px !important;
                }

                .btn-primary,
                .btn-primary-pro,
                .btn-danger,
                .btn-secondary {
                    width: 100% !important;
                    padding: 12px !important;
                    margin-top: 8px;
                    font-size: 0.95rem !important;
                    font-weight: 600;
                    border-radius: 8px !important;
                }
            </style>

            <!-- CONSOLA DE EMERGENCIA INTEGRADA -->
            <div id="emergency-console"
                style="display:none; position:fixed; bottom:0; left:0; right:0; height:300px; background:#1e1e1e; color:#00ff00; font-family:monospace; font-size:12px; z-index:99999; border-top:3px solid #00ff00; overflow-y:auto; padding:10px;">
                <div
                    style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; border-bottom:1px solid #00ff00; padding-bottom:5px;">
                    <strong style="color:#00ff00;">üîß CONSOLA DE EMERGENCIA</strong>
                    <button onclick="document.getElementById('emergency-console').style.display='none'"
                        style="background:#ff0000; color:white; border:none; padding:5px 10px; cursor:pointer; border-radius:3px;">CERRAR</button>
                </div>
                <div id="console-output" style="white-space:pre-wrap; word-wrap:break-word;"></div>
                <div style="margin-top:10px; display:flex; gap:5px;">
                    <input id="console-input" type="text" placeholder="Escribe comando aqu√≠..."
                        style="flex:1; background:#2d2d2d; color:#00ff00; border:1px solid #00ff00; padding:5px; font-family:monospace;">
                    <button onclick="executeConsoleCommand()"
                        style="background:#00ff00; color:black; border:none; padding:5px 15px; cursor:pointer; font-weight:bold;">EJECUTAR</button>
                </div>
            </div>

            <!-- Bot√≥n flotante para abrir consola -->
            <button onclick="document.getElementById('emergency-console').style.display='block'"
                style="position:fixed; bottom:20px; right:20px; background:#00ff00; color:black; border:none; padding:15px 20px; border-radius:50px; cursor:pointer; font-weight:bold; z-index:99998; box-shadow:0 4px 15px rgba(0,255,0,0.4); font-size:14px;">
                üîß CONSOLA
            </button>

            <script>
                // Interceptar console.log y mostrarlo en nuestra consola
                (function () {
                    const originalLog = console.log;
                    const originalError = console.error;
                    const originalWarn = console.warn;

                    function addToConsole(message, type = 'log') {
                        const output = document.getElementById('console-output');
                        if (output) {
                            const color = type === 'error' ? '#ff0000' : type === 'warn' ? '#ffff00' : '#00ff00';
                            const timestamp = new Date().toLocaleTimeString();
                            output.innerHTML += `<div style="color:${color}; margin-bottom:5px;">[${timestamp}] ${message}</div>`;
                            output.scrollTop = output.scrollHeight;
                        }
                    }

                    console.log = function (...args) {
                        originalLog.apply(console, args);
                        addToConsole(args.join(' '), 'log');
                    };

                    console.error = function (...args) {
                        originalError.apply(console, args);
                        addToConsole('‚ùå ERROR: ' + args.join(' '), 'error');
                    };

                    console.warn = function (...args) {
                        originalWarn.apply(console, args);
                        addToConsole('‚ö†Ô∏è WARNING: ' + args.join(' '), 'warn');
                    };

                    // Ejecutar comandos desde la consola
                    window.executeConsoleCommand = function () {
                        const input = document.getElementById('console-input');
                        const command = input.value.trim();

                        if (!command) return;

                        addToConsole('> ' + command, 'log');

                        try {
                            const result = eval(command);
                            if (result !== undefined) {
                                if (result && typeof result.then === 'function') {
                                    result.then(r => addToConsole('‚Üê ' + JSON.stringify(r, null, 2), 'log'))
                                        .catch(e => addToConsole('‚ùå ' + e.message, 'error'));
                                } else {
                                    addToConsole('‚Üê ' + JSON.stringify(result, null, 2), 'log');
                                }
                            }
                        } catch (error) {
                            addToConsole('‚ùå ' + error.message, 'error');
                        }

                        input.value = '';
                    };

                    // Permitir Enter para ejecutar
                    document.addEventListener('DOMContentLoaded', () => {
                        const input = document.getElementById('console-input');
                        if (input) {
                            input.addEventListener('keypress', (e) => {
                                if (e.key === 'Enter') executeConsoleCommand();
                            });
                        }

                        // Mensaje de bienvenida
                        setTimeout(() => {
                            addToConsole('‚úÖ Consola de emergencia cargada', 'log');
                            addToConsole('Puedes ejecutar comandos JavaScript aqu√≠', 'log');
                        }, 1000);
                    });
                })();
            </script>
</body>

</html>